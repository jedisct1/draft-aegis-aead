<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The AEGIS family of authenticated encryption algorithms</title>
<meta content="Frank Denis" name="author">
<meta content="Fabio Enrico Renzo Scotoni" name="author">
<meta content="Samuel Lucas" name="author">
<meta content="
       This document describes AEGIS-128L and AEGIS-256, two AES-based authenticated encryption algorithms designed for high-performance applications. 
    " name="description">
<meta content="xml2rfc 3.12.10" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-denis-aegis-aead-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.10
    Python 3.10.4
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
-->
<link href="draft-denis-aegis-aead.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The AEGIS family of authenticated encryp</td>
<td class="right">June 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Denis, et al.</td>
<td class="center">Expires 18 December 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-denis-aegis-aead-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-06-16" class="published">16 June 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-12-18">18 December 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Denis</div>
<div class="org">Fastly Inc.</div>
</div>
<div class="author">
      <div class="author-name">F. E. R. Scotoni</div>
<div class="org">Individual Contributor</div>
</div>
<div class="author">
      <div class="author-name">S. Lucas</div>
<div class="org">Individual Contributor</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The AEGIS family of authenticated encryption algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes AEGIS-128L and AEGIS-256, two AES-based authenticated encryption algorithms designed for high-performance applications.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/jedisct1/draft-aegis-aead">https://github.com/jedisct1/draft-aegis-aead</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 December 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-definitions" class="xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-the-aegis-128l-algorithm" class="xref">The AEGIS-128L Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-authenticated-encryption" class="xref">Authenticated Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-authenticated-decryption" class="xref">Authenticated Decryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-the-init-function" class="xref">The Init Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-the-update-function" class="xref">The Update Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-the-enc-function" class="xref">The Enc Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-the-dec-function" class="xref">The Dec Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-the-decpartial-function" class="xref">The DecPartial Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-the-finalize-function" class="xref">The Finalize Function</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-the-aegis-256-algorithm" class="xref">The AEGIS-256 Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-authenticated-encryption-2" class="xref">Authenticated Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-authenticated-decryption-2" class="xref">Authenticated Decryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-the-init-function-2" class="xref">The Init Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-the-update-function-2" class="xref">The Update Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-the-enc-function-2" class="xref">The Enc Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-the-dec-function-2" class="xref">The Dec Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-the-decpartial-function-2" class="xref">The DecPartial Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-the-finalize-function-2" class="xref">The Finalize Function</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-encoding-ct-tag-tuples" class="xref">Encoding (ct, tag) Tuples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-aesround-test-vector" class="xref">AESRound Test Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-aegis-128l-test-vectors" class="xref">AEGIS-128L Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#appendix-A.2.1" class="xref">A.2.1</a>.  <a href="#name-update-test-vector" class="xref">Update Test Vector</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#appendix-A.2.2" class="xref">A.2.2</a>.  <a href="#name-test-vector-1" class="xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#appendix-A.2.3" class="xref">A.2.3</a>.  <a href="#name-test-vector-2" class="xref">Test Vector 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#appendix-A.2.4" class="xref">A.2.4</a>.  <a href="#name-test-vector-3" class="xref">Test Vector 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.5">
                    <p id="section-toc.1-1.9.2.2.2.5.1"><a href="#appendix-A.2.5" class="xref">A.2.5</a>.  <a href="#name-test-vector-4" class="xref">Test Vector 4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.6">
                    <p id="section-toc.1-1.9.2.2.2.6.1"><a href="#appendix-A.2.6" class="xref">A.2.6</a>.  <a href="#name-test-vector-5" class="xref">Test Vector 5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.7">
                    <p id="section-toc.1-1.9.2.2.2.7.1"><a href="#appendix-A.2.7" class="xref">A.2.7</a>.  <a href="#name-test-vector-6" class="xref">Test Vector 6</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.8">
                    <p id="section-toc.1-1.9.2.2.2.8.1"><a href="#appendix-A.2.8" class="xref">A.2.8</a>.  <a href="#name-test-vector-7" class="xref">Test Vector 7</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.9">
                    <p id="section-toc.1-1.9.2.2.2.9.1"><a href="#appendix-A.2.9" class="xref">A.2.9</a>.  <a href="#name-test-vector-8" class="xref">Test Vector 8</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.10">
                    <p id="section-toc.1-1.9.2.2.2.10.1"><a href="#appendix-A.2.10" class="xref">A.2.10</a>. <a href="#name-test-vector-9" class="xref">Test Vector 9</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-aegis-256-test-vectors" class="xref">AEGIS-256 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#appendix-A.3.1" class="xref">A.3.1</a>.  <a href="#name-update-test-vector-2" class="xref">Update Test Vector</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#appendix-A.3.2" class="xref">A.3.2</a>.  <a href="#name-test-vector-1-2" class="xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.3">
                    <p id="section-toc.1-1.9.2.3.2.3.1"><a href="#appendix-A.3.3" class="xref">A.3.3</a>.  <a href="#name-test-vector-2-2" class="xref">Test Vector 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4">
                    <p id="section-toc.1-1.9.2.3.2.4.1"><a href="#appendix-A.3.4" class="xref">A.3.4</a>.  <a href="#name-test-vector-3-2" class="xref">Test Vector 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.5">
                    <p id="section-toc.1-1.9.2.3.2.5.1"><a href="#appendix-A.3.5" class="xref">A.3.5</a>.  <a href="#name-test-vector-4-2" class="xref">Test Vector 4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.6">
                    <p id="section-toc.1-1.9.2.3.2.6.1"><a href="#appendix-A.3.6" class="xref">A.3.6</a>.  <a href="#name-test-vector-5-2" class="xref">Test Vector 5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.7">
                    <p id="section-toc.1-1.9.2.3.2.7.1"><a href="#appendix-A.3.7" class="xref">A.3.7</a>.  <a href="#name-test-vector-6-2" class="xref">Test Vector 6</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.8">
                    <p id="section-toc.1-1.9.2.3.2.8.1"><a href="#appendix-A.3.8" class="xref">A.3.8</a>.  <a href="#name-test-vector-7-2" class="xref">Test Vector 7</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.9">
                    <p id="section-toc.1-1.9.2.3.2.9.1"><a href="#appendix-A.3.9" class="xref">A.3.9</a>.  <a href="#name-test-vector-8-2" class="xref">Test Vector 8</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.10">
                    <p id="section-toc.1-1.9.2.3.2.10.1"><a href="#appendix-A.3.10" class="xref">A.3.10</a>. <a href="#name-test-vector-9-2" class="xref">Test Vector 9</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes the AEGIS-128L and AEGIS-256 authenticated encryption with associated data (AEAD) algorithms <span>[<a href="#AEGIS" class="xref">AEGIS</a>]</span>, which were chosen as additional finalists for high-performance applications in the Competition for Authenticated Encryption: Security, Applicability, and Robustness (CAESAR). Whilst AEGIS-128 was selected as a winner for this use case, AEGIS-128L has a better security margin alongside improved performance and AEGIS-256 uses a 256-bit key <span>[<a href="#LIMS21" class="xref">LIMS21</a>]</span>. All variants of AEGIS are constructed from the AES encryption round function <span>[<a href="#FIPS-AES" class="xref">FIPS-AES</a>]</span>. This document specifies:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">AEGIS-128L, which has a 128-bit key, a 128-bit nonce, a 1024-bit state, a 128-bit authentication tag, and processes 256-bit input blocks.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">AEGIS-256, which has a 256-bit key, a 256-bit nonce, a 768-bit state, a 128-bit authentication tag, and processes 128-bit input blocks.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">The AEGIS cipher family offers performance that significantly exceeds that of AES-GCM with hardware support for parallelizable AES block encryption <span>[<a href="#AEGIS" class="xref">AEGIS</a>]</span>. Similarly, software implementations can also be faster, although to a lesser extent.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Unlike with AES-GCM, nonces can be safely chosen at random with no practical limit when using AEGIS-256. AEGIS-128L also allows for more messages to be safely encrypted when using random nonces.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">With some existing AEAD schemes, such as AES-GCM, an attacker can generate a ciphertext that successfully decrypts under multiple different keys (a partitioning oracle attack) <span>[<a href="#LGR21" class="xref">LGR21</a>]</span>. This ability to craft a (ciphertext, authentication tag) pair that verifies under multiple keys significantly reduces the number of required interactions with the oracle in order to perform an exhaustive search, making it practical if the key space is small. For example, with password-based encryption, an attacker can guess a large number of passwords at a time by recursively submitting such a ciphertext to an oracle, which speeds up a password search by reducing it to a binary search.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">A key-committing AEAD scheme is more resistant against partitioning oracle attacks than non-committing AEAD schemes, making it significantly harder to find multiple keys that are valid for a given authentication tag. As of the time of writing, no research has been published claiming that AEGIS is not a key-committing AEAD scheme.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Finally, unlike most other AES-based AEAD constructions, such as Rocca and Tiaoxin, leaking the state does not leak the key.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Note that an earlier version of Hongjun Wu and Bart Preneel's paper introducing AEGIS specified AEGIS-128L and AEGIS-256 sporting differences with regards to the computation of the authentication tag and the number of rounds in <code>Finalize()</code> respectively. We follow the specification of <span>[<a href="#AEGIS" class="xref">AEGIS</a>]</span> that is current at the time of writing, which can be found in the References section of this document.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Primitives:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
          <code>|x|</code>: the length of <code>x</code> in bits.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">
          <code>a ^ b</code>: the bitwise exclusive OR operation between <code>a</code> and <code>b</code>.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">
          <code>a &amp; b</code>: the bitwise AND operation between <code>a</code> and <code>b</code>.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">
          <code>a || b</code>: the concatenation of <code>a</code> and <code>b</code>.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.5">
          <code>a mod b</code>: the remainder of the Euclidean division between <code>a</code> as the dividend and <code>b</code> as the divisor.<a href="#section-2-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.6">
          <code>LE64(x)</code>: the little-endian encoding of 64-bit integer <code>x</code>.<a href="#section-2-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.7">
          <code>ZeroPad(x, n)</code>: padding operation. Trailing zeros are concatenated to <code>x</code> until the total length is a multiple of <code>n</code> bits.<a href="#section-2-3.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.8">
          <code>Truncate(x, n)</code>: truncation operation. The first <code>n</code> bits of <code>x</code> are kept.<a href="#section-2-3.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.9">
          <code>Split(x, n)</code>: splitting operation. <code>x</code> is split into <code>n</code>-bit blocks, ignoring partial blocks.<a href="#section-2-3.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.10">
          <code>Tail(x, n)</code>: returns the last <code>n</code> bits of <code>x</code>.<a href="#section-2-3.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.11">
          <code>AESRound(in, rk)</code>: a single round of the AES encryption round function, which is the composition of the <code>SubBytes</code>, <code>ShiftRows</code>, <code>MixColums</code> and <code>AddRoundKey</code> transformations, as defined in section 5 of <span>[<a href="#FIPS-AES" class="xref">FIPS-AES</a>]</span>. Here, <code>in</code> is the 128-bit AES input state, and <code>rk</code> is the 128-bit round key.<a href="#section-2-3.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.12">
          <code>Repeat(n, F)</code>: <code>n</code> sequential evaluations of the function <code>F</code>.<a href="#section-2-3.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.13">
          <code>CtEq(a, b)</code>: compares <code>a</code> and <code>b</code> in constant-time, returning <code>True</code> for an exact match, <code>False</code> otherwise.<a href="#section-2-3.13" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">AEGIS internal functions:<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">
          <code>Update(M0, M1)</code>: the state update function.<a href="#section-2-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.2">
          <code>Init(key, nonce)</code>: the initialization function.<a href="#section-2-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.3">
          <code>Enc(xi)</code>: the input block encryption function.<a href="#section-2-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.4">
          <code>Dec(ci)</code>: the input block decryption function.<a href="#section-2-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.5">
          <code>DecPartial(cn)</code>: the input block decryption function for the last ciphertext bits when they do not fill an entire block.<a href="#section-2-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.6">
          <code>Finalize(ad_len, msg_len)</code>: the authentication tag generation function.<a href="#section-2-5.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-6">Input blocks are 256 bits for AEGIS-128L and 128 bits for AEGIS-256.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">AES blocks:<a href="#section-2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-8.1">
          <code>Si</code>: the <code>i</code>-th AES block of the current state.<a href="#section-2-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-8.2">
          <code>S'i</code>: the <code>i</code>-th AES block of the next state.<a href="#section-2-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-8.3">
          <code>{Si, ...Sj}</code>: the vector of the <code>i</code>-th AES block of the current state to the <code>j</code>-th block of the current state.<a href="#section-2-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-8.4">
          <code>C0</code>: the constant <code>0x000101020305080d1522375990e97962</code> as an AES block.<a href="#section-2-8.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-8.5">
          <code>C1</code>: the constant <code>0xdb3d18556dc22ff12011314273b528dd</code> as an AES block.<a href="#section-2-8.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-9">AES blocks are always 128 bits in length.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">Input and output values:<a href="#section-2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-11.1">
          <code>key</code>: the encryption key (128 bits for AEGIS-128L, 256 bits for AEGIS-256).<a href="#section-2-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-11.2">
          <code>nonce</code>: the public nonce (128 bits for AEGIS-128L, 256 bits for AEGIS-256).<a href="#section-2-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-11.3">
          <code>ad</code>: the associated data.<a href="#section-2-11.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-11.4">
          <code>msg</code>: the plaintext.<a href="#section-2-11.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-11.5">
          <code>ct</code>: the ciphertext.<a href="#section-2-11.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-11.6">
          <code>tag</code>: the authentication tag (128 bits).<a href="#section-2-11.6" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="the-aegis-128l-algorithm">
<section id="section-3">
      <h2 id="name-the-aegis-128l-algorithm">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-aegis-128l-algorithm" class="section-name selfRef">The AEGIS-128L Algorithm</a>
      </h2>
<p id="section-3-1">AEGIS-128L has a 1024-bit state, made of eight 128-bit blocks <code>{S0, ...S7}</code>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The parameters for this algorithm, whose meaning is defined in <span>[<a href="#RFC5116" class="xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-4" class="relref">Section 4</a></span> are:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <code>K_LEN</code> (key length) is 16 octets (128 bits).<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.2">
          <code>P_MAX</code> (maximum length of the plaintext) is 2<sup>61</sup> octets (2<sup>64</sup> bits).<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.3">
          <code>A_MAX</code> (maximum length of the associated data) is 2<sup>61</sup> octets (2<sup>64</sup> bits).<a href="#section-3-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.4">
          <code>N_MIN</code> (minimum nonce length) = <code>N_MAX</code> (maximum nonce length) = 16 octets (128 bits).<a href="#section-3-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.5">
          <code>C_MAX</code> (maximum ciphertext length) = <code>P_MAX</code> + tag length = 2<sup>61</sup> + 16 octets (2<sup>64</sup> + 128 bits).<a href="#section-3-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-4">Distinct associated data inputs, as described in <span>[<a href="#RFC5116" class="xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-3" class="relref">Section 3</a></span> shall be unambiguously encoded as a single input.
It is up to the application to create a structure in the associated data input if needed.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="authenticated-encryption">
<section id="section-3.1">
        <h3 id="name-authenticated-encryption">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authenticated-encryption" class="section-name selfRef">Authenticated Encryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.1-1">
<pre>
Encrypt(msg, ad, key, nonce)
</pre><a href="#section-3.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.1-2">The <code>Encrypt</code> function encrypts a message and returns the ciphertext along with an authentication tag that verifies the authenticity of the message and associated data, if provided.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Security:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">For a given key, the nonce <span class="bcp14">MUST NOT</span> be reused under any circumstances; doing so allows an attacker to recover the internal state.<a href="#section-3.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-4.2">The key <span class="bcp14">MUST</span> be randomly chosen from a uniform distribution.<a href="#section-3.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-5">Inputs:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
            <code>msg</code>: the message to be encrypted (length <span class="bcp14">MUST</span> be less than <code>P_MAX</code>).<a href="#section-3.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.2">
            <code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than <code>A_MAX</code>).<a href="#section-3.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.3">
            <code>key</code>: the encryption key.<a href="#section-3.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.4">
            <code>nonce</code>: the public nonce.<a href="#section-3.1-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-7">Outputs:<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.1">
            <code>ct</code>: the ciphertext.<a href="#section-3.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-8.2">
            <code>tag</code>: the authentication tag.<a href="#section-3.1-8.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-9">Steps:<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-10">
<pre>
Init(key, nonce)

ct = {}

ad_blocks = Split(ZeroPad(ad, 256), 256)
for xi in ad_blocks:
    Enc(xi)

msg_blocks = Split(ZeroPad(msg, 256), 256)
for xi in msg_blocks:
    ct = ct || Enc(xi)

tag = Finalize(|ad|, |msg|)
ct = Truncate(ct, |msg|)

return ct and tag
</pre><a href="#section-3.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authenticated-decryption">
<section id="section-3.2">
        <h3 id="name-authenticated-decryption">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authenticated-decryption" class="section-name selfRef">Authenticated Decryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.2-1">
<pre>
Decrypt(ct, tag, ad, key, nonce)
</pre><a href="#section-3.2-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2-2">The <code>Decrypt</code> function decrypts a ciphertext, verifies that the authentication tag is correct, and returns the message on success or an error if tag verification failed.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Security:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">If tag verification fails, the decrypted message and wrong message authentication tag <span class="bcp14">MUST NOT</span> be given as output. The decrypted message <span class="bcp14">MUST</span> be overwritten with zeros.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-4.2">The comparison of the input <code>tag</code> with the <code>expected_tag</code> <span class="bcp14">MUST</span> be done in constant time.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-5">Inputs:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <code>ct</code>: the ciphertext to be decrypted (length <span class="bcp14">MUST</span> be less than <code>C_MAX</code>).<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">
            <code>tag</code>: the authentication tag.<a href="#section-3.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.3">
            <code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than <code>A_MAX</code>).<a href="#section-3.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.4">
            <code>key</code>: the encryption key.<a href="#section-3.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.5">
            <code>nonce</code>: the public nonce.<a href="#section-3.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-7">Outputs:<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">Either the decrypted message <code>msg</code>, or an error indicating that the authentication tag is invalid for the given inputs.<a href="#section-3.2-8.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-9">Steps:<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-10">
<pre>
Init(key, nonce)

msg = {}

ad_blocks = Split(ZeroPad(ad, 256), 256)
for xi in ad_blocks:
    Enc(xi)

ct_blocks = Split(ct, 256)
cn = Tail(ct, |ct| mod 256)

for ci in ct_blocks:
    msg = msg || Dec(ci)

if cn is not empty:
    msg = msg || DecPartial(cn)

expected_tag = Finalize(|ad|, |msg|)

if CtEq(tag, expected_tag) is False:
    erase msg
    return "verification failed" error
else:
    return msg
</pre><a href="#section-3.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-init-function">
<section id="section-3.3">
        <h3 id="name-the-init-function">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-the-init-function" class="section-name selfRef">The Init Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.3-1">
<pre>
Init(key, nonce)
</pre><a href="#section-3.3-1" class="pilcrow">¶</a>
</div>
<p id="section-3.3-2">The <code>Init</code> function constructs the initial state <code>{S0, ...S7}</code> using the given <code>key</code> and <code>nonce</code>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Inputs:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">
            <code>key</code>: the encryption key.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-4.2">
            <code>nonce</code>: the nonce.<a href="#section-3.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-5">Defines:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-6.1">
            <code>{S0, ...S7}</code>: the initial state.<a href="#section-3.3-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-7">Steps:<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-8">
<pre>
S0 = key ^ nonce
S1 = C1
S2 = C0
S3 = C1
S4 = key ^ nonce
S5 = key ^ C0
S6 = key ^ C1
S7 = key ^ C0

Repeat(10, Update(nonce, key))
</pre><a href="#section-3.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-update-function">
<section id="section-3.4">
        <h3 id="name-the-update-function">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-the-update-function" class="section-name selfRef">The Update Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.4-1">
<pre>
Update(M0, M1)
</pre><a href="#section-3.4-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4-2">The <code>Update</code> function is the core of the AEGIS-128L algorithm.
It updates the state <code>{S0, ...S7}</code> using two 128-bit values.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">Inputs:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-4.1">
            <code>M0</code>: the first 128-bit block to be absorbed.<a href="#section-3.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-4.2">
            <code>M1</code>: the second 128-bit block to be absorbed.<a href="#section-3.4-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-5">Modifies:<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <code>{S0, ...S7}</code>: the state.<a href="#section-3.4-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-7">Steps:<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-8">
<pre>
S'0 = AESRound(S7, S0 ^ M0)
S'1 = AESRound(S0, S1)
S'2 = AESRound(S1, S2)
S'3 = AESRound(S2, S3)
S'4 = AESRound(S3, S4 ^ M1)
S'5 = AESRound(S4, S5)
S'6 = AESRound(S5, S6)
S'7 = AESRound(S6, S7)

S0  = S'0
S1  = S'1
S2  = S'2
S3  = S'3
S4  = S'4
S5  = S'5
S6  = S'6
S7  = S'7
</pre><a href="#section-3.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-enc-function">
<section id="section-3.5">
        <h3 id="name-the-enc-function">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-the-enc-function" class="section-name selfRef">The Enc Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.5-1">
<pre>
Enc(xi)
</pre><a href="#section-3.5-1" class="pilcrow">¶</a>
</div>
<p id="section-3.5-2">The <code>Enc</code> function encrypts a 256-bit input block <code>xi</code> using the state <code>{S0, ...S7}</code>.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">Inputs:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-4.1">
            <code>xi</code>: the 256-bit input block.<a href="#section-3.5-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-5">Outputs:<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-6.1">
            <code>ci</code>: the 256-bit encrypted block.<a href="#section-3.5-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-7">Steps:<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-8">
<pre>
z0 = S6 ^ S1 ^ (S2 &amp; S3)
z1 = S2 ^ S5 ^ (S6 &amp; S7)

t0, t1 = Split(xi, 128)
out0 = t0 ^ z0
out1 = t1 ^ z1

Update(t0, t1)
ci = out0 || out1

return ci
</pre><a href="#section-3.5-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-dec-function">
<section id="section-3.6">
        <h3 id="name-the-dec-function">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-the-dec-function" class="section-name selfRef">The Dec Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.6-1">
<pre>
Dec(ci)
</pre><a href="#section-3.6-1" class="pilcrow">¶</a>
</div>
<p id="section-3.6-2">The <code>Dec</code> function decrypts a 256-bit input block <code>ci</code> using the state <code>{S0, ...S7}</code>.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">Inputs:<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-4.1">
            <code>ci</code>: the 256-bit encrypted block.<a href="#section-3.6-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-5">Outputs:<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-6.1">
            <code>xi</code>: the 256-bit decrypted block.<a href="#section-3.6-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-7">Steps:<a href="#section-3.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-8">
<pre>
z0 = S6 ^ S1 ^ (S2 &amp; S3)
z1 = S2 ^ S5 ^ (S6 &amp; S7)

t0, t1 = Split(ci, 128)
out0 = t0 ^ z0
out1 = t1 ^ z1

Update(out0, out1)
xi = out0 || out1

return xi
</pre><a href="#section-3.6-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-decpartial-function">
<section id="section-3.7">
        <h3 id="name-the-decpartial-function">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-the-decpartial-function" class="section-name selfRef">The DecPartial Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.7-1">
<pre>
DecPartial(cn)
</pre><a href="#section-3.7-1" class="pilcrow">¶</a>
</div>
<p id="section-3.7-2">The <code>DecPartial</code> function decrypts the last ciphertext bits <code>cn</code> using the state <code>{S0, ...S7}</code> when they do not fill an entire block.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">Inputs:<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-4.1">
            <code>cn</code>: the encrypted input.<a href="#section-3.7-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.7-5">Outputs:<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-6.1">
            <code>xn</code>: the decryption of <code>cn</code>.<a href="#section-3.7-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.7-7">Steps:<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-8">
<pre>
z0 = S6 ^ S1 ^ (S2 &amp; S3)
z1 = S2 ^ S5 ^ (S6 &amp; S7)

t0, t1 = Split(ZeroPad(cn, 256), 128)
out0 = t0 ^ z0
out1 = t1 ^ z1

xn = Truncate(out0 || out1, |cn|)

v0, v1 = Split(ZeroPad(xn, 256), 128)
Update(v0, v1)

return xn
</pre><a href="#section-3.7-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-finalize-function">
<section id="section-3.8">
        <h3 id="name-the-finalize-function">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-the-finalize-function" class="section-name selfRef">The Finalize Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.8-1">
<pre>
Finalize(ad_len, msg_len)
</pre><a href="#section-3.8-1" class="pilcrow">¶</a>
</div>
<p id="section-3.8-2">The <code>Finalize</code> function computes a 128-bit tag that authenticates the message and associated data.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">Inputs:<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-4.1">
            <code>ad_len</code>: the length of the associated data in bits.<a href="#section-3.8-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-4.2">
            <code>msg_len</code>: the length of the message in bits.<a href="#section-3.8-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.8-5">Outputs:<a href="#section-3.8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-6.1">
            <code>tag</code>: the authentication tag.<a href="#section-3.8-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.8-7">Steps:<a href="#section-3.8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.8-8">
<pre>
t = S2 ^ (LE64(ad_len) || LE64(msg_len))

Repeat(7, Update(t, t))

tag = S0 ^ S1 ^ S2 ^ S3 ^ S4 ^ S5 ^ S6

return tag
</pre><a href="#section-3.8-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="the-aegis-256-algorithm">
<section id="section-4">
      <h2 id="name-the-aegis-256-algorithm">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-aegis-256-algorithm" class="section-name selfRef">The AEGIS-256 Algorithm</a>
      </h2>
<p id="section-4-1">AEGIS-256 has a 768-bit state, made of six 128-bit blocks <code>{S0, ...S5}</code>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The parameters for this algorithm, whose meaning is defined in <span>[<a href="#RFC5116" class="xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-4" class="relref">Section 4</a></span> are:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <code>K_LEN</code> (key length) is 32 octets (256 bits).<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.2">
          <code>P_MAX</code> (maximum length of the plaintext) is 2<sup>61</sup> octets (2<sup>64</sup> bits).<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.3">
          <code>A_MAX</code> (maximum length of the associated data) is 2<sup>61</sup> octets (2<sup>64</sup> bits).<a href="#section-4-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.4">
          <code>N_MIN</code> (minimum nonce length) = <code>N_MAX</code> (maximum nonce length) = 32 octets (256 bits).<a href="#section-4-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.5">
          <code>C_MAX</code> (maximum ciphertext length) = <code>P_MAX</code> + tag length = 2<sup>61</sup> + 16 octets (2<sup>64</sup> + 128 bits).<a href="#section-4-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-4">Distinct associated data inputs, as described in <span>[<a href="#RFC5116" class="xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-3" class="relref">Section 3</a></span> shall be unambiguously encoded as a single input.
It is up to the application to create a structure in the associated data input if needed.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="authenticated-encryption-1">
<section id="section-4.1">
        <h3 id="name-authenticated-encryption-2">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authenticated-encryption-2" class="section-name selfRef">Authenticated Encryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.1-1">
<pre>
Encrypt(msg, ad, key, nonce)
</pre><a href="#section-4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.1-2">The <code>Encrypt</code> function encrypts a message and returns the ciphertext along with an authentication tag that verifies the authenticity of the message and associated data, if provided.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Security:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">For a given key, the nonce <span class="bcp14">MUST NOT</span> be reused under any circumstances; doing so allows an attacker to recover the internal state.<a href="#section-4.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-4.2">The key <span class="bcp14">MUST</span> be randomly chosen from a uniform distribution.<a href="#section-4.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-5">Inputs:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-6.1">
            <code>msg</code>: the message to be encrypted (length <span class="bcp14">MUST</span> be less than <code>P_MAX</code>).<a href="#section-4.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-6.2">
            <code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than <code>A_MAX</code>).<a href="#section-4.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-6.3">
            <code>key</code>: the encryption key.<a href="#section-4.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-6.4">
            <code>nonce</code>: the public nonce.<a href="#section-4.1-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-7">Outputs:<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-8.1">
            <code>ct</code>: the ciphertext.<a href="#section-4.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-8.2">
            <code>tag</code>: the authentication tag.<a href="#section-4.1-8.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-9">Steps:<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-10">
<pre>
Init(key, nonce)

ct = {}

ad_blocks = Split(ZeroPad(ad, 128), 128)
for xi in ad_blocks:
    Enc(xi)

msg_blocks = Split(ZeroPad(msg, 128), 128)
for xi in msg_blocks:
    ct = ct || Enc(xi)

tag = Finalize(|ad|, |msg|)
ct = Truncate(ct, |msg|)

return ct and tag
</pre><a href="#section-4.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authenticated-decryption-1">
<section id="section-4.2">
        <h3 id="name-authenticated-decryption-2">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-authenticated-decryption-2" class="section-name selfRef">Authenticated Decryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.2-1">
<pre>
Decrypt(ct, tag, ad, key, nonce)
</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2">The <code>Decrypt</code> function decrypts a ciphertext, verifies that the authentication tag is correct, and returns the message on success or an error if tag verification failed.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Security:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">If tag verification fails, the decrypted message and wrong message authentication tag <span class="bcp14">MUST NOT</span> be given as output. The decrypted message <span class="bcp14">MUST</span> be overwritten with zeros.<a href="#section-4.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-4.2">The comparison of the input <code>tag</code> with the <code>expected_tag</code> <span class="bcp14">MUST</span> be done in constant time.<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-5">Inputs:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-6.1">
            <code>ct</code>: the ciphertext to be decrypted (length <span class="bcp14">MUST</span> be less than <code>C_MAX</code>).<a href="#section-4.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-6.2">
            <code>tag</code>: the authentication tag.<a href="#section-4.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-6.3">
            <code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than <code>A_MAX</code>).<a href="#section-4.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-6.4">
            <code>key</code>: the encryption key.<a href="#section-4.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-6.5">
            <code>nonce</code>: the public nonce.<a href="#section-4.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-7">Outputs:<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-8.1">Either the decrypted message <code>msg</code>, or an error indicating that the authentication tag is invalid for the given inputs.<a href="#section-4.2-8.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-9">Steps:<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-10">
<pre>
Init(key, nonce)

msg = {}

ad_blocks = Split(ZeroPad(ad, 128), 128)
for xi in ad_blocks:
    Enc(xi)

ct_blocks = Split(ZeroPad(ct, 128), 128)
cn = Tail(ct, |ct| mod 128)

for ci in ct_blocks:
    msg = msg || Dec(ci)

if cn is not empty:
    msg = msg || DecPartial(cn)

expected_tag = Finalize(|ad|, |msg|)

if CtEq(tag, expected_tag) is False:
    erase msg
    return "verification failed" error
else:
    return msg
</pre><a href="#section-4.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-init-function-1">
<section id="section-4.3">
        <h3 id="name-the-init-function-2">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-the-init-function-2" class="section-name selfRef">The Init Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.3-1">
<pre>
Init(key, nonce)
</pre><a href="#section-4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3-2">The <code>Init</code> function constructs the initial state <code>{S0, ...S5}</code> using the given <code>key</code> and <code>nonce</code>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Inputs:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">
            <code>key</code>: the encryption key.<a href="#section-4.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-4.2">
            <code>nonce</code>: the nonce.<a href="#section-4.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-5">Defines:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">
            <code>{S0, ...S5}</code>: the initial state.<a href="#section-4.3-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-7">Steps:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-8">
<pre>
k0, k1 = Split(key, 128)
n0, n1 = Split(nonce, 128)

S0 = k0 ^ n0
S1 = k1 ^ n1
S2 = C1
S3 = C0
S4 = k0 ^ C0
S5 = k1 ^ C1

Repeat(4,
  Update(k0)
  Update(k1)
  Update(k0 ^ n0)
  Update(k1 ^ n1)
)
</pre><a href="#section-4.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-update-function-1">
<section id="section-4.4">
        <h3 id="name-the-update-function-2">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-the-update-function-2" class="section-name selfRef">The Update Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.4-1">
<pre>
Update(M)
</pre><a href="#section-4.4-1" class="pilcrow">¶</a>
</div>
<p id="section-4.4-2">The <code>Update</code> function is the core of the AEGIS-256 algorithm.
It updates the state <code>{S0, ...S5}</code> using a 128-bit value.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Inputs:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">
            <code>msg</code>: the block to be absorbed.<a href="#section-4.4-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.4-5">Modifies:<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-6.1">
            <code>{S0, ...S5}</code>: the state.<a href="#section-4.4-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.4-7">Steps:<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-8">
<pre>
S'0 = AESRound(S5, S0 ^ M)
S'1 = AESRound(S0, S1)
S'2 = AESRound(S1, S2)
S'3 = AESRound(S2, S3)
S'4 = AESRound(S3, S4)
S'5 = AESRound(S4, S5)

S0  = S'0
S1  = S'1
S2  = S'2
S3  = S'3
S4  = S'4
S5  = S'5
</pre><a href="#section-4.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-enc-function-1">
<section id="section-4.5">
        <h3 id="name-the-enc-function-2">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-the-enc-function-2" class="section-name selfRef">The Enc Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.5-1">
<pre>
Enc(xi)
</pre><a href="#section-4.5-1" class="pilcrow">¶</a>
</div>
<p id="section-4.5-2">The <code>Enc</code> function encrypts a 128-bit input block <code>xi</code> using the state <code>{S0, ...S5}</code>.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Inputs:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-4.1">
            <code>xi</code>: the input block.<a href="#section-4.5-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-5">Outputs:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-6.1">
            <code>ci</code>: the encrypted input block.<a href="#section-4.5-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-7">Steps:<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-8">
<pre>
z = S1 ^ S4 ^ S5 ^ (S2 &amp; S3)

Update(xi)

ci = xi ^ z

return ci
</pre><a href="#section-4.5-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-dec-function-1">
<section id="section-4.6">
        <h3 id="name-the-dec-function-2">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-the-dec-function-2" class="section-name selfRef">The Dec Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.6-1">
<pre>
Dec(ci)
</pre><a href="#section-4.6-1" class="pilcrow">¶</a>
</div>
<p id="section-4.6-2">The <code>Dec</code> function decrypts a 128-bit input block <code>ci</code> using the state <code>{S0, ...S5}</code>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">Inputs:<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-4.1">
            <code>ci</code>: the encrypted input block.<a href="#section-4.6-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.6-5">Outputs:<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-6.1">
            <code>xi</code>: the decrypted block.<a href="#section-4.6-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.6-7">Steps:<a href="#section-4.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-8">
<pre>
z = S1 ^ S4 ^ S5 ^ (S2 &amp; S3)

xi = ci ^ z

Update(xi)

return xi
</pre><a href="#section-4.6-8" class="pilcrow">¶</a>
</div>
<p id="section-4.6-9">It returns the 128-bit block <code>out</code>.<a href="#section-4.6-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-decpartial-function-1">
<section id="section-4.7">
        <h3 id="name-the-decpartial-function-2">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-the-decpartial-function-2" class="section-name selfRef">The DecPartial Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.7-1">
<pre>
DecPartial(cn)
</pre><a href="#section-4.7-1" class="pilcrow">¶</a>
</div>
<p id="section-4.7-2">The <code>DecPartial</code> function decrypts the last ciphertext bits <code>cn</code> using the state <code>{S0, ...S5}</code> when they do not fill an entire block.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">Inputs:<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-4.1">
            <code>cn</code>: the encrypted input.<a href="#section-4.7-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.7-5">Outputs:<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-6.1">
            <code>xn</code>: the decryption of <code>cn</code>.<a href="#section-4.7-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.7-7">Steps:<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7-8">
<pre>
z = S1 ^ S4 ^ S5 ^ (S2 &amp; S3)

t = ZeroPad(cn, 128)
out = t ^ z

xn = Truncate(out, |cn|)

v = ZeroPad(xn, 128)
Update(v)

return xn
</pre><a href="#section-4.7-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-finalize-function-1">
<section id="section-4.8">
        <h3 id="name-the-finalize-function-2">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-the-finalize-function-2" class="section-name selfRef">The Finalize Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.8-1">
<pre>
Finalize(ad_len, msg_len)
</pre><a href="#section-4.8-1" class="pilcrow">¶</a>
</div>
<p id="section-4.8-2">The <code>Finalize</code> function computes a 128-bit tag that authenticates the message and associated data.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">Inputs:<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-4.1">
            <code>ad_len</code>: the length of the associated data in bits.<a href="#section-4.8-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.8-4.2">
            <code>msg_len</code>: the length of the message in bits.<a href="#section-4.8-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.8-5">Outputs:<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-6.1">
            <code>tag</code>: the authentication tag.<a href="#section-4.8-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.8-7">Steps:<a href="#section-4.8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8-8">
<pre>
t = S3 ^ (LE64(ad_len) || LE64(msg_len))

Repeat(7, Update(t))

tag = S0 ^ S1 ^ S2 ^ S3 ^ S4 ^ S5

return tag
</pre><a href="#section-4.8-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="encoding-ct-tag-tuples">
<section id="section-5">
      <h2 id="name-encoding-ct-tag-tuples">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-encoding-ct-tag-tuples" class="section-name selfRef">Encoding (ct, tag) Tuples</a>
      </h2>
<p id="section-5-1">Applications <span class="bcp14">MAY</span> keep the ciphertext and the 128-bit authentication tag in distinct structures or encode both as a single string.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In the latter case, the tag <span class="bcp14">MUST</span> immediately follow the ciphertext:<a href="#section-5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-3">
<pre>
combined_ct = ct || tag
</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">AEGIS-256 offers 256-bit message security against plaintext and state recovery, whereas AEGIS-128L offers 128-bit security. Both have a 128-bit authentication tag, which implies that a given tag may verify under multiple keys. However, assuming AEGIS is key-committing, finding equivalent keys is expected to be significantly more difficult than for authentication schemes based on polynomial evaluation, such as GCM and Poly1305.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Under the assumption that the secret key is unknown to the attacker and the tag is not truncated, both AEGIS-128L and AEGIS-256 target 128-bit security against forgery attacks.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Both algorithms <span class="bcp14">MUST</span> be used in a nonce-respecting setting: for a given <code>key</code>, a <code>nonce</code> <span class="bcp14">MUST</span> only be used once. Failure to do so would immediately reveal the bitwise difference between two messages.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">If tag verification fails, the decrypted message and wrong message authentication tag <span class="bcp14">MUST NOT</span> be given as output. As shown in the analysis of the (robustness of CAESAR candidates beyond their guarantees)<span>[<a href="#CRA18" class="xref">CRA18</a>]</span>, even a partial leak of the plaintext without verification would facilitate chosen ciphertext attacks.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Every key <span class="bcp14">MUST</span> be randomly chosen from a uniform distribution.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">The nonce <span class="bcp14">MAY</span> be public or predictable. It can be a counter, the output of a permutation, or a generator with a long period.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">With AEGIS-128L, random nonces can safely encrypt up to 2<sup>48</sup> messages using the same key with negligible collision probability.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">With AEGIS-256, random nonces can be used with no practical limits.<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">The security of AEGIS against timing and physical attacks is limited by the implementation of the underlying <code>AESRound()</code> function. Failure to implement <code>AESRound()</code> in a fashion safe against timing and physical attacks, such as differential power analysis, timing analysis or fault injection attacks, may lead to leakage of secret key material or state information. The exact mitigations required for timing and physical attacks also depend on the threat model in question.<a href="#section-6-9" class="pilcrow">¶</a></p>
<p id="section-6-10">Security analyses of AEGIS can be found in Chapter 4 of <span>[<a href="#AEGIS" class="xref">AEGIS</a>]</span>, in <span>[<a href="#Min14" class="xref">Min14</a>]</span>, in <span>[<a href="#ENP19" class="xref">ENP19</a>]</span>, in <span>[<a href="#LIMS21" class="xref">LIMS21</a>]</span>, and in <span>[<a href="#JLD21" class="xref">JLD21</a>]</span>.<a href="#section-6-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">IANA is requested to assign entries for <code>AEAD_AEGIS128L</code> and <code>AEAD_AEGIS256</code> in the AEAD Registry with this document as reference.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS-AES">[FIPS-AES]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Advanced Encryption Standard (AES)"</span>, <span class="seriesInfo">FIPS PUB 197</span>, <time datetime="2001-11" class="refDate">November 2001</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AEGIS">[AEGIS]</dt>
        <dd>
<span class="refAuthor">Wu, H.</span> and <span class="refAuthor">B. Preneel</span>, <span class="refTitle">"AEGIS: A fast encryption algorithm (v1.1)"</span>, <time datetime="2016-09-15" class="refDate">15 September 2016</time>, <span>&lt;<a href="https://competitions.cr.yp.to/round3/aegisv11.pdf">https://competitions.cr.yp.to/round3/aegisv11.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CRA18">[CRA18]</dt>
        <dd>
<span class="refAuthor">Vaudenay, S.</span> and <span class="refAuthor">D. Vizár</span>, <span class="refTitle">"Can Caesar Beat Galois? Robustness of CAESAR Candidates against Nonce Reusing and High Data Complexity Attacks"</span>, <span class="refContent">Applied Cryptography and Network Security. ACNS 2018. Lecture Notes in Computer Science, vol 10892, pp. 476–494</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-93387-0_25</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-93387-0_25">https://doi.org/10.1007/978-3-319-93387-0_25</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ENP19">[ENP19]</dt>
        <dd>
<span class="refAuthor">Eichlseder, M.</span>, <span class="refAuthor">Nageler, M.</span>, and <span class="refAuthor">R. Primas</span>, <span class="refTitle">"Analyzing the Linear Keystream Biases in AEGIS"</span>, <span class="refContent">IACR Transactions on Symmetric Cryptology, 2019(4), pp. 348–368</span>, <span class="seriesInfo">DOI 10.13154/tosc.v2019.i4.348-368</span>, <time datetime="2020-01-31" class="refDate">31 January 2020</time>, <span>&lt;<a href="https://doi.org/10.13154/tosc.v2019.i4.348-368">https://doi.org/10.13154/tosc.v2019.i4.348-368</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JLD21">[JLD21]</dt>
        <dd>
<span class="refAuthor">Jiao, L.</span>, <span class="refAuthor">Li, Y.</span>, and <span class="refAuthor">S. Du</span>, <span class="refTitle">"Guess-and-Determine Attacks on AEGIS"</span>, <span class="refContent">The Computer Journal</span>, <span class="seriesInfo">DOI 10.1093/comjnl/bxab059</span>, <time datetime="2021-05-22" class="refDate">22 May 2021</time>, <span>&lt;<a href="https://doi.org/10.1093/comjnl/bxab059">https://doi.org/10.1093/comjnl/bxab059</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LGR21">[LGR21]</dt>
        <dd>
<span class="refAuthor">Len, J.</span>, <span class="refAuthor">Grubbs, P.</span>, and <span class="refAuthor">T. Ristenpart</span>, <span class="refTitle">"Partitioning Oracle Attacks"</span>, <span class="refContent">30th USENIX Security Symposium (USENIX Security 21), pp. 195–212</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.usenix.org/conference/usenixsecurity21/presentation/len">https://www.usenix.org/conference/usenixsecurity21/presentation/len</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LIMS21">[LIMS21]</dt>
        <dd>
<span class="refAuthor">Liu, F.</span>, <span class="refAuthor">Isobe, T.</span>, <span class="refAuthor">Meier, W.</span>, and <span class="refAuthor">K. Sakamoto</span>, <span class="refTitle">"Weak Keys in Reduced AEGIS and Tiaoxin"</span>, <span class="refContent">IACR Transactions on Symmetric Cryptology, 2021(2), pp. 104–139</span>, <span class="seriesInfo">DOI 10.46586/tosc.v2021.i2.104-139</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/187">https://eprint.iacr.org/2021/187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Min14">[Min14]</dt>
      <dd>
<span class="refAuthor">Minaud, B.</span>, <span class="refTitle">"Linear Biases in AEGIS Keystream"</span>, <span class="refContent">Selected Areas in Cryptography. SAC 2014. Lecture Notes in Computer Science, vol 8781, pp. 290–305</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-13051-4_18</span>, <time datetime="2014" class="refDate">2014</time>, <span>&lt;<a href="https://eprint.iacr.org/2018/292">https://eprint.iacr.org/2018/292</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<div id="aesround-test-vector">
<section id="appendix-A.1">
        <h3 id="name-aesround-test-vector">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-aesround-test-vector" class="section-name selfRef">AESRound Test Vector</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.1-1">
<pre>
in   : 000102030405060708090a0b0c0d0e0f

rk   : 101112131415161718191a1b1c1d1e1f

out  : 7a7b4e5638782546a8c0477a3b813f43
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aegis-128l-test-vectors">
<section id="appendix-A.2">
        <h3 id="name-aegis-128l-test-vectors">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-aegis-128l-test-vectors" class="section-name selfRef">AEGIS-128L Test Vectors</a>
        </h3>
<div id="update-test-vector">
<section id="appendix-A.2.1">
          <h4 id="name-update-test-vector">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-update-test-vector" class="section-name selfRef">Update Test Vector</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.1-1">
<pre>
S0   : 9b7e60b24cc873ea894ecc07911049a3
S1   : 330be08f35300faa2ebf9a7b0d274658
S2   : 7bbd5bd2b049f7b9b515cf26fbe7756c
S3   : c35a00f55ea86c3886ec5e928f87db18
S4   : 9ebccafce87cab446396c4334592c91f
S5   : 58d83e31f256371e60fc6bb257114601
S6   : 1639b56ea322c88568a176585bc915de
S7   : 640818ffb57dc0fbc2e72ae93457e39a

M0   : 033e6975b94816879e42917650955aa0
M1   : 033e6975b94816879e42917650955aa0

After Update:
S0   : 596ab773e4433ca0127c73f60536769d
S1   : 790394041a3d26ab697bde865014652d
S2   : 38cf49e4b65248acd533041b64dd0611
S3   : 16d8e58748f437bfff1797f780337cee
S4   : 69761320f7dd738b281cc9f335ac2f5a
S5   : a21746bb193a569e331e1aa985d0d729
S6   : 09d714e6fcf9177a8ed1cde7e3d259a6
S7   : 61279ba73167f0ab76f0a11bf203bdff
</pre><a href="#appendix-A.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1">
<section id="appendix-A.2.2">
          <h4 id="name-test-vector-1">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-test-vector-1" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.2-1">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   :

msg  : 00000000000000000000000000000000

ct   : c1c0e58bd913006feba00f4b3cc3594e

tag  : abe0ece80c24868a226a35d16bdae37a
</pre><a href="#appendix-A.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2">
<section id="appendix-A.2.3">
          <h4 id="name-test-vector-2">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-test-vector-2" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.3-1">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   :

msg  :

ct   :

tag  : c2b879a67def9d74e6c14f708bbcc9b4
</pre><a href="#appendix-A.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3">
<section id="appendix-A.2.4">
          <h4 id="name-test-vector-3">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-test-vector-3" class="section-name selfRef">Test Vector 3</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.4-1">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   : 0001020304050607

msg  : 000102030405060708090a0b0c0d0e0f
       101112131415161718191a1b1c1d1e1f

ct   : 79d94593d8c2119d7e8fd9b8fc77845c
       5c077a05b2528b6ac54b563aed8efe84

tag  : cc6f3372f6aa1bb82388d695c3962d9a
</pre><a href="#appendix-A.2.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-4">
<section id="appendix-A.2.5">
          <h4 id="name-test-vector-4">
<a href="#appendix-A.2.5" class="section-number selfRef">A.2.5. </a><a href="#name-test-vector-4" class="section-name selfRef">Test Vector 4</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.5-1">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   : 0001020304050607

msg  : 000102030405060708090a0b0c0d

ct   : 79d94593d8c2119d7e8fd9b8fc77

tag  : 5c04b3dba849b2701effbe32c7f0fab7
</pre><a href="#appendix-A.2.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-5">
<section id="appendix-A.2.6">
          <h4 id="name-test-vector-5">
<a href="#appendix-A.2.6" class="section-number selfRef">A.2.6. </a><a href="#name-test-vector-5" class="section-name selfRef">Test Vector 5</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.6-1">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   : 000102030405060708090a0b0c0d0e0f
       101112131415161718191a1b1c1d1e1f
       20212223242526272829

msg  : 101112131415161718191a1b1c1d1e1f
       202122232425262728292a2b2c2d2e2f
       3031323334353637

ct   : b31052ad1cca4e291abcf2df3502e6bd
       b1bfd6db36798be3607b1f94d34478aa
       7ede7f7a990fec10

tag  : 7542a745733014f9474417b337399507
</pre><a href="#appendix-A.2.6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-6">
<section id="appendix-A.2.7">
          <h4 id="name-test-vector-6">
<a href="#appendix-A.2.7" class="section-number selfRef">A.2.7. </a><a href="#name-test-vector-6" class="section-name selfRef">Test Vector 6</a>
          </h4>
<p id="appendix-A.2.7-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.2.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.7-2">
<pre>
key  : 10000200000000000000000000000000

nonce: 10010000000000000000000000000000

ad   : 0001020304050607

ct   : 79d94593d8c2119d7e8fd9b8fc77

tag  : 5c04b3dba849b2701effbe32c7f0fab7
</pre><a href="#appendix-A.2.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-7">
<section id="appendix-A.2.8">
          <h4 id="name-test-vector-7">
<a href="#appendix-A.2.8" class="section-number selfRef">A.2.8. </a><a href="#name-test-vector-7" class="section-name selfRef">Test Vector 7</a>
          </h4>
<p id="appendix-A.2.8-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.2.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.8-2">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   : 0001020304050607

ct   : 79d94593d8c2119d7e8fd9b8fc78

tag  : 5c04b3dba849b2701effbe32c7f0fab7
</pre><a href="#appendix-A.2.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-8">
<section id="appendix-A.2.9">
          <h4 id="name-test-vector-8">
<a href="#appendix-A.2.9" class="section-number selfRef">A.2.9. </a><a href="#name-test-vector-8" class="section-name selfRef">Test Vector 8</a>
          </h4>
<p id="appendix-A.2.9-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.2.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.9-2">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   : 0001020304050608

ct   : 79d94593d8c2119d7e8fd9b8fc77

tag  : 5c04b3dba849b2701effbe32c7f0fab7
</pre><a href="#appendix-A.2.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-9">
<section id="appendix-A.2.10">
          <h4 id="name-test-vector-9">
<a href="#appendix-A.2.10" class="section-number selfRef">A.2.10. </a><a href="#name-test-vector-9" class="section-name selfRef">Test Vector 9</a>
          </h4>
<p id="appendix-A.2.10-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.2.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.10-2">
<pre>
key  : 10010000000000000000000000000000

nonce: 10000200000000000000000000000000

ad   : 0001020304050607

ct   : 79d94593d8c2119d7e8fd9b8fc77

tag  : 6c04b3dba849b2701effbe32c7f0fab8
</pre><a href="#appendix-A.2.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-256-test-vectors">
<section id="appendix-A.3">
        <h3 id="name-aegis-256-test-vectors">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-aegis-256-test-vectors" class="section-name selfRef">AEGIS-256 Test Vectors</a>
        </h3>
<div id="update-test-vector-1">
<section id="appendix-A.3.1">
          <h4 id="name-update-test-vector-2">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-update-test-vector-2" class="section-name selfRef">Update Test Vector</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-1">
<pre>
S0   : 1fa1207ed76c86f2c4bb40e8b395b43e
S1   : b44c375e6c1e1978db64bcd12e9e332f
S2   : 0dab84bfa9f0226432ff630f233d4e5b
S3   : d7ef65c9b93e8ee60c75161407b066e7
S4   : a760bb3da073fbd92bdc24734b1f56fb
S5   : a828a18d6a964497ac6e7e53c5f55c73

M    : b165617ed04ab738afb2612c6d18a1ec

After Update:
S0   : e6bc643bae82dfa3d991b1b323839dcd
S1   : 648578232ba0f2f0a3677f617dc052c3
S2   : ea788e0e572044a46059212dd007a789
S3   : 2f1498ae19b80da13fba698f088a8590
S4   : a54c2ee95e8c2a2c3dae2ec743ae6b86
S5   : a3240fceb68e32d5d114df1b5363ab67
</pre><a href="#appendix-A.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1-1">
<section id="appendix-A.3.2">
          <h4 id="name-test-vector-1-2">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-test-vector-1-2" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.3.2-1">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   :

msg  : 00000000000000000000000000000000

ct   : 754fc3d8c973246dcc6d741412a4b236

tag  : 3fe91994768b332ed7f570a19ec5896e
</pre><a href="#appendix-A.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-1">
<section id="appendix-A.3.3">
          <h4 id="name-test-vector-2-2">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-test-vector-2-2" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.3.3-1">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   :

msg  :

ct   :

tag  : e3def978a0f054afd1e761d7553afba3
</pre><a href="#appendix-A.3.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-1">
<section id="appendix-A.3.4">
          <h4 id="name-test-vector-3-2">
<a href="#appendix-A.3.4" class="section-number selfRef">A.3.4. </a><a href="#name-test-vector-3-2" class="section-name selfRef">Test Vector 3</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.3.4-1">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   : 0001020304050607

msg  : 000102030405060708090a0b0c0d0e0f
       101112131415161718191a1b1c1d1e1f

ct   : f373079ed84b2709faee373584585d60
       accd191db310ef5d8b11833df9dec711

tag  : 8d86f91ee606e9ff26a01b64ccbdd91d
</pre><a href="#appendix-A.3.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-4-1">
<section id="appendix-A.3.5">
          <h4 id="name-test-vector-4-2">
<a href="#appendix-A.3.5" class="section-number selfRef">A.3.5. </a><a href="#name-test-vector-4-2" class="section-name selfRef">Test Vector 4</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-1">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   : 0001020304050607

msg  : 000102030405060708090a0b0c0d

ct   : f373079ed84b2709faee37358458

tag  : c60b9c2d33ceb058f96e6dd03c215652
</pre><a href="#appendix-A.3.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-5-1">
<section id="appendix-A.3.6">
          <h4 id="name-test-vector-5-2">
<a href="#appendix-A.3.6" class="section-number selfRef">A.3.6. </a><a href="#name-test-vector-5-2" class="section-name selfRef">Test Vector 5</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.3.6-1">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   : 000102030405060708090a0b0c0d0e0f
       101112131415161718191a1b1c1d1e1f
       20212223242526272829

msg  : 101112131415161718191a1b1c1d1e1f
       202122232425262728292a2b2c2d2e2f
       3031323334353637

ct   : 57754a7d09963e7c787583a2e7b859bb
       24fa1e04d49fd550b2511a358e3bca25
       2a9b1b8b30cc4a67

tag  : ab8a7d53fd0e98d727accca94925e128
</pre><a href="#appendix-A.3.6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-6-1">
<section id="appendix-A.3.7">
          <h4 id="name-test-vector-6-2">
<a href="#appendix-A.3.7" class="section-number selfRef">A.3.7. </a><a href="#name-test-vector-6-2" class="section-name selfRef">Test Vector 6</a>
          </h4>
<p id="appendix-A.3.7-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.3.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.7-2">
<pre>
key  : 10000200000000000000000000000000
       00000000000000000000000000000000

nonce: 10010000000000000000000000000000
       00000000000000000000000000000000

ad   : 0001020304050607

ct   : f373079ed84b2709faee37358458

tag  : c60b9c2d33ceb058f96e6dd03c215652
</pre><a href="#appendix-A.3.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-7-1">
<section id="appendix-A.3.8">
          <h4 id="name-test-vector-7-2">
<a href="#appendix-A.3.8" class="section-number selfRef">A.3.8. </a><a href="#name-test-vector-7-2" class="section-name selfRef">Test Vector 7</a>
          </h4>
<p id="appendix-A.3.8-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.3.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.8-2">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   : 0001020304050607

ct   : f373079ed84b2709faee37358459

tag  : c60b9c2d33ceb058f96e6dd03c215652
</pre><a href="#appendix-A.3.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-8-1">
<section id="appendix-A.3.9">
          <h4 id="name-test-vector-8-2">
<a href="#appendix-A.3.9" class="section-number selfRef">A.3.9. </a><a href="#name-test-vector-8-2" class="section-name selfRef">Test Vector 8</a>
          </h4>
<p id="appendix-A.3.9-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.3.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.9-2">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   : 0001020304050608

ct   : f373079ed84b2709faee37358458

tag  : c60b9c2d33ceb058f96e6dd03c215652
</pre><a href="#appendix-A.3.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-9-1">
<section id="appendix-A.3.10">
          <h4 id="name-test-vector-9-2">
<a href="#appendix-A.3.10" class="section-number selfRef">A.3.10. </a><a href="#name-test-vector-9-2" class="section-name selfRef">Test Vector 9</a>
          </h4>
<p id="appendix-A.3.10-1">This test <span class="bcp14">MUST</span> return a "verification failed" error.<a href="#appendix-A.3.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.10-2">
<pre>
key  : 10010000000000000000000000000000
       00000000000000000000000000000000

nonce: 10000200000000000000000000000000
       00000000000000000000000000000000

ad   : 0001020304050607

ct   : f373079ed84b2709faee37358458

tag  : d60b9c2d33ceb058f96e6dd03c215653
</pre><a href="#appendix-A.3.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The AEGIS authenticated encryption algorithm was invented by Hongjun Wu and Bart Preneel.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The round function leverages the AES permutation invented by Joan Daemen and Vincent Rijmen. They also authored the Pelican MAC that partly motivated the design of the AEGIS MAC.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">We would like to thank Eric Lagergren and Daniel Bleichenbacher for catching a broken test vector and Daniel Bleichenbacher for many helpful suggestions.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Frank Denis</span></div>
<div dir="auto" class="left"><span class="org">Fastly Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fde@00f.net" class="email">fde@00f.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fabio Enrico Renzo Scotoni</span></div>
<div dir="auto" class="left"><span class="org">Individual Contributor</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fabio@esse.ch" class="email">fabio@esse.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Lucas</span></div>
<div dir="auto" class="left"><span class="org">Individual Contributor</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:samuel-lucas6@pm.me" class="email">samuel-lucas6@pm.me</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
